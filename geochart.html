<html>
	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"> </script>
		 <script type="text/javascript">

function getJSONBanjir() {
	return $.getJSON('https://raw.githubusercontent.com/MalvinJu/visdat/master/data/banjir.json');
}
function getJSONGempa() {
	return $.getJSON('https://raw.githubusercontent.com/MalvinJu/visdat/master/data/gempa.json');
}
function getJSONKebakaran() {
	return $.getJSON('https://raw.githubusercontent.com/MalvinJu/visdat/master/data/kebakaran.json');
}
function getJSONKerugian() {
	return $.getJSON('https://raw.githubusercontent.com/MalvinJu/visdat/master/data/kerugiangabungan.json');
}
function getJSONPulau() {
	return $.getJSON('https://raw.githubusercontent.com/MalvinJu/visdat/master/data/tespulau.json');
}

//MAP
var arrayMapData = [];
var label = [ {label: 'LATITUDE', id: 'Latitude', type: 'number'},
							{label: 'LONGITUDE', id: 'Longitude', type: 'number'},
							{label: 'DESCRIPTION', id: 'Description', type: 'string'},
							{label: 'VALUE', id: 'value', type: 'number'}];
arrayMapData.push(label);

var arrayBanjirData = [];
var labelBanjir = ['Provinsi', 'Jumlah'];
arrayBanjirData.push(labelBanjir);

var arrayGempaData = [];
var labelGempa = ['Provinsi', 'Jumlah'];
arrayGempaData.push(labelGempa);

var arrayKebakaranData = [];
var labelKebakaran = ['Provinsi', 'Jumlah'];
arrayKebakaranData.push(labelKebakaran);

var arrayTotalData = [];
var labelTotal = ['Provinsi', 'Jumlah'];
arrayTotalData.push(labelTotal);

$.when(getJSONBanjir()).then(function (dataBanjir) {
	$.each(dataBanjir, function(i, f) {   
		x = [f.latitude, f.longitude, 'Banjir', 1]
		arrayMapData.push(x)
	});
});
$.when(getJSONGempa()).then(function (dataGempa) {
	$.each(dataGempa, function(i, f) {   
		x = [f.latitude, f.longitude, 'Gempa bumi', 1]
		arrayMapData.push(x)
	});
});
$.when(getJSONKebakaran()).then(function (dataKebakaran) {
	$.each(dataKebakaran, function(i, f) {   
		x = [f.latitude, f.longitude, 'Kebakaran hutan', 1]
		arrayMapData.push(x)
	});
});
$.when(getJSONPulau()).then(function (data) {
	$.each(data, function(i, f) {
		if(data != undefined && f.dataProvinsi != undefined){
			nBencana = 0
			nBanjir = 0
			nGempa = 0
			nKebakaran = 0
			$.each(f.dataProvinsi, function (j, perPulau){
				nBanjir = parseFloat(perPulau.nBanjir)
				nGempa = parseFloat(perPulau.nGempa)
				nKebakaran = parseFloat(perPulau.nKebakaran)
				nBencana = nBanjir + nGempa + nKebakaran
				banjirdata = [perPulau.provinsi, nBanjir]
				gempadata = [perPulau.provinsi, nGempa]
				kebakarandata = [perPulau.provinsi, nKebakaran]
				totaldata = [perPulau.provinsi, nBencana]
				arrayBanjirData.push(banjirdata);
				arrayGempaData.push(gempadata);
				arrayKebakaranData.push(kebakarandata);
				arrayTotalData.push(totaldata);
			})
		}
	})
});

google.charts.load('current', {
		'packages':['geochart'],
		'mapsApiKey': 'AIzaSyD-9tSrke72PouQMnMX-a7eZSW0jkFMBWY'
});
google.charts.setOnLoadCallback(drawTotalMap);

function drawScatterMap() {
	var x = google.visualization.arrayToDataTable(arrayMapData);

	var options = {
		region: 'ID',
		displayMode: 'markers',
		sizeAxis: { minValue: -2, maxValue: 5, minSize: 1, maxSize: 5},
		legend: 'none',
		colorAxis: {colors: ['#808080']}
	};

	var chart = new google.visualization.GeoChart(document.getElementById('map'));
	chart.draw(x, options);
};

function drawBanjirMap() {
	var x = google.visualization.arrayToDataTable(arrayBanjirData);

	var options = {
		region: 'ID',
		resolution: 'provinces',
		colorAxis: {colors: [ '#f8f8f8', '#384ba0' ]},
		backgroundColor: '#fdfdfd',
		datalessRegionColor: '#ffffff',
		defaultColor: '#f5f5f5'
	};

	var chart = new google.visualization.GeoChart(document.getElementById('map'));
	chart.draw(x, options);
};

function drawGempaMap() {
	var x = google.visualization.arrayToDataTable(arrayGempaData);

	var options = {
		region: 'ID',
		resolution: 'provinces',
		colorAxis: {colors: [ '#f8f8f8', '#b25728' ]},
		backgroundColor: '#fdfdfd',
		datalessRegionColor: '#ffffff',
		defaultColor: '#f5f5f5'
	};

	var chart = new google.visualization.GeoChart(document.getElementById('map'));
	chart.draw(x, options);
};

function drawKebakaranMap() {
	var x = google.visualization.arrayToDataTable(arrayKebakaranData);

	var options = {
		region: 'ID',
		resolution: 'provinces',
		colorAxis: {colors: [ '#f8f8f8', '#f3b31e' ]},
		backgroundColor: '#fdfdfd',
		datalessRegionColor: '#ffffff',
		defaultColor: '#f5f5f5'
	};

	var chart = new google.visualization.GeoChart(document.getElementById('map'));
	chart.draw(x, options);
};

function drawTotalMap() {
	var x = google.visualization.arrayToDataTable(arrayTotalData);

	var options = {
		region: 'ID',
		resolution: 'provinces',
		colorAxis: {colors: [ '#f8f8f8', '#0f0f0f' ]},
		backgroundColor: '#fdfdfd',
		datalessRegionColor: '#ffffff',
		defaultColor: '#f5f5f5'
	};

	var chart = new google.visualization.GeoChart(document.getElementById('map'));
	chart.draw(x, options);
};

	</script>

	<head>
	</head>
	<body>
	<div id="map"></div>
			
</body>
</html>